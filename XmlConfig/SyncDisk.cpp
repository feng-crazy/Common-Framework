/******************************************************************************
	  COPYRIGHT: 2008 Edan Instruments, Inc. All rights reserved
	PROJECTNAME: Mx
	    VERSION: 1.0
	   FILENAME: SyncDisk.cpp
	    CREATED: 2011.12.19
	       作者: 张虎
	   功能描述: 保存配置文件到磁盘。
******************************************************************************/
#include "SyncDisk.h"

/******************************************************************************
作者: 张虎，2011.12.19
功能描述:
参数说明:
返回值:
******************************************************************************/
SyncDiskIFace::SyncDiskIFace()
{

}

/******************************************************************************
作者: 张虎，2011.12.19
功能描述:
参数说明:
返回值:
******************************************************************************/
SyncDiskIFace::~SyncDiskIFace()
{

}

/******************************************************************************
作者: 张虎，2011.12.19
功能描述:
参数说明:
返回值:
******************************************************************************/
bool SyncDisk::register_sync_iface(SyncDiskIFace &disk_iface)
{
	std::pair<std::set<SyncDiskIFace*>::iterator, bool> ret;
	ret = _disk_iface.insert(&disk_iface);
	return ret.second;
}

/******************************************************************************
作者: 张虎，2011.12.19
功能描述:
参数说明:
返回值:
******************************************************************************/
void SyncDisk::thread_run(void)
{
	std::set<SyncDiskIFace*>::iterator it = _disk_iface.begin();
	for(; it != _disk_iface.end(); ++it)
	{
		(*it)->save_file();
	}

	usleep(200000);
}


/******************************************************************************
作者：张虎，2011.12.19
功能描述：
参数说明：
返回值：
******************************************************************************/
void SyncDisk::setup_thread(void)
{
	run();
}

/******************************************************************************
作者: 张虎，2011.12.19
功能说明:
参数说明:
返回值
******************************************************************************/
SyncDisk::SyncDisk() : MThread()
{
	MThread::init();
}

/******************************************************************************
作者: 张虎，2011.12.19
功能说明:
参数说明:
返回值
******************************************************************************/
SyncDisk::~SyncDisk()
{

}

